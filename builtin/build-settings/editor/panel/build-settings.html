<html><head></head><body><polymer-element name="build-settings" constructor="BuildSettings" assetpath=""><template><style>:host { color: #ddd; background: #303030; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;}.title { width: 100%; float: left; background-color: #242424; font-size: 18px; line-height: 40px; padding-left: 15px; border-bottom: 1px solid #424242;}.title h2 { margin-top: 10px; margin-bottom: 10px; float: left;}.title .tip { color: #f00; font-size: 12px; line-height: 60px; margin-left: 20px; float: left; display: none;}.section { width: 100%; height: auto; float: left;}.path { font-size: 10px;}.prop { height: 24px; margin-left: 15px; margin-top: 10px; margin-right: 15px; padding-bottom: 10px; border-bottom: 1px solid #282828;}.prop fire-ui-label { font-size: 13px;}.item-box { height: 100px; max-height: 100px; overflow: hidden; margin-top: 5px;}.border { border: 1px solid #999; position: absolute; max-height: 100px; left: 191px; width: 296px;}.items { min-height: 80px; overflow-x: hidden; overflow-y: auto;}.items fire-ui-checkbox { margin: 3px;}.box-border { min-height: 80px; border: 1px solid #999;}.link { font-size: 12px; -webkit-user-select: initial; text-decoration: underline; cursor: pointer;}.link:hover { color: #0c90e6;}.btn-group { width: 100%; height: auto; float: left; margin-top: 12px; margin-bottom: 5px;}.btn-group button { float: right; width: 80px; height: 30px; margin-right: 15px; border: 1px solid #252525; border-radius: 2px; padding: 4px 8px; cursor: pointer; color: #bdbdbd;}.btn-group button li { font-size: 20px; cursor: pointer; color: #fff;}.btn-group button:focus { outline: none;}.btn-group button.green { background-color: #090;}.btn-group button.green:hover { background-color: #00bd00;}.btn-group button.green:active { background-color: #008a00;}.btn-group button.red { background-color: #900;}.btn-group button.red:hover { background-color: #bd0000;}.btn-group button.red:active { background-color: #8a0000;}.btn-group .hide { display: none;}.btn-group .disabled { pointer-events: none;}.btn-group .disabled.green { background-color: #343434; color: #5f5f5f;}fire-ui-label { text-align: right; margin-right: 20px;}</style><div class="title"><h2>Build Settings</h2><span class="tip" id="tip">Please enter the correct data!</span></div><div class="section"><div flex-row="" class="prop"><fire-ui-label flex-1="">Project Name</fire-ui-label><fire-ui-text-input value="{{profiles.project.projectName}}" invalid="{{!isProjectNameValid}}" placeholder="Project Name" flex-2=""></fire-ui-text-input></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Platform</fire-ui-label><fire-ui-select flex-2="" value="{{profiles.project.platform}}" options="{{platformList}}"></fire-ui-select></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Build Path</fire-ui-label><div flex-row="" flex-2=""><fire-ui-text-input value="{{profiles.project.buildPath}}" invalid="{{!isBuildPathValid}}" placeholder="Building Path" flex-4=""></fire-ui-text-input><fire-ui-button style="margin-left: 5px" on-click="{{chooseDistPath}}">...</fire-ui-button></div></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Show in {{finderOrExplorer}}</fire-ui-label><div flex-row="" flex-2=""><span flex-4="" class="path">{{profiles.project.buildPath}}</span><fire-ui-button on-click="{{showInFinder}}">Show in {{finderOrExplorer}}</fire-ui-button></div></div><div flex-row="" class="prop"><fire-ui-label id="test" flex-1="">Start Scene</fire-ui-label><fire-ui-select flex-2="" value="{{profiles.project.defaultScene}}" options="{{profiles.project.sceneList}}"></fire-ui-select></div><div flex-row="" class="prop item-box"><fire-ui-label flex-1="">Scenes In Build</fire-ui-label><div flex-2="" class="items"><div class="box-border"><template repeat="{{item in profiles.project.sceneList}}"><fire-ui-checkbox disabled="{{item.value == profiles.project.defaultScene}}" on-click="{{itemClickAction}}" value="{{item.checked}}" id="{{item.value}}">{{item.name}}</fire-ui-checkbox></template></div></div></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Debug Mode</fire-ui-label><fire-ui-checkbox flex-2="" value="{{profiles.project.isDebug}}"></fire-ui-checkbox></div><div flex-row="" class="prop"><fire-ui-label flex-1="">Preview</fire-ui-label><div flex-row="" flex-2=""><span class="link" flex-4="" on-click="{{previewAction}}">http://localhost:7456</span><fire-ui-button on-click="{{previewAction}}">Open in Browser</fire-ui-button></div></div></div><div class="btn-group"><button class="green {{profiles.project.sceneList.length == 0 ?'disabled':''}}" on-mouseenter="{{buildButtonHoverInAction}}" on-mouseleave="{{buildButtonHoverOutAction}}" on-click="{{buildAction}}"><span class="{{hoverBuildButton? 'hide':''}}">Build</span><li class="fa fa-download {{!hoverBuildButton? 'hide':''}}"></li></button><button class="red" on-click="{{closeAction}}">Close</button></div></template><script>(function(){var Remote=require("remote");var Url=require("fire-url");var Fs=require("fire-fs");var Path=require("fire-path");var Shell=require("shell");Polymer("build-settings",{platformList:[{name:"Web Mobile",value:"web-mobile"},{name:"Web Desktop",value:"web-desktop"}],observe:{"profiles.project.projectName":"projectNameChanged","profiles.project.defaultScene":"defaultSceneChanged","profiles.project.platform":"platformChanged","profiles.project.isDebug":"isDebugChanged","profiles.project.buildPath":"buildPathChanged"},isProjectNameValid:true,isBuildPathValid:true,hoverBuildButton:false,finderOrExplorer:Fire.isDarwin?"Finder":"Explorer",domReady:function(){Editor.sendToCore("build-settings:query-scenes")},"panel:open":function(event){var projectPath=Remote.getGlobal("Editor").projectPath;var projectName=Path.basename(projectPath);var profile=this.profiles.project;if(profile.projectName===""){profile.projectName=projectName}if(profile.buildPath===""){profile.buildPath=Path.join(projectPath,"mobile-"+projectName)}},"build-settings:query-scenes-results":function(event){var results=event.detail.results;var profile=this.profiles.project;profile.sceneList=results.map(function(item){return{name:item.url,value:item.uuid,checked:true}});if(profile.sceneList.indexOf(profile.defaultScene)===-1){if(profile.sceneList.length===0){this.$.tip.style.display="block";this.$.tip.innerHTML="Please create a new scene,then you can to build!";Fire.warn("Please create a new scene,then you can to build!");return}profile.defaultScene=profile.sceneList[0].value}profile.save()},defaultSceneChanged:function(){var profile=this.profiles.project;for(var i=0;i<profile.sceneList.length;++i){if(profile.sceneList[i].value===profile.defaultScene){profile.sceneList[i].checked=true}}profile.save()},buildPathChanged:function(){var profile=this.profiles.project;profile.save();if(profile.buildPath){this.isBuildPathValid=true;return}this.isBuildPathValid=false},projectNameChanged:function(){var profile=this.profiles.project;profile.save();if(profile.projectName){this.isProjectNameValid=true;return}this.isProjectNameValid=false},platformChanged:function(){var profile=this.profiles.project;var projectPath=Remote.getGlobal("Editor").projectPath;if(profile.platform==="web-mobile"){profile.buildPath=Path.join(projectPath,+"/mobile-"+profile.projectName)}else{profile.buildPath=Path.join(projectPath,+"/desktop-"+profile.projectName)}profile.save()},isDebugChanged:function(){var profile=this.profiles.project;profile.save()},chooseDistPath:function(){var dialog=Remote.require("dialog");var projectPath=Remote.getGlobal("Editor").projectPath;dialog.showOpenDialog({defaultPath:projectPath,properties:["openDirectory"]},function(res){var profile=this.profiles.project;if(res){if(profile.platform==="web-mobile"){profile.buildPath=res+"/mobile-"+Path.basename(projectPath)}else{profile.buildPath=res+"/desktop-"+Path.basename(projectPath)}}}.bind(this))},buildAction:function(){if(this.isProjectNameValid&&this.isBuildPathValid){this.$.tip.style.display="none";var profile=this.profiles.project;var buildUuidList=profile.sceneList.filter(function(item){return item.checked}).map(function(item){return item.value});var firstSceneIndex=buildUuidList.indexOf(profile.defaultScene);var toSwap=buildUuidList[0];buildUuidList[0]=buildUuidList[firstSceneIndex];buildUuidList[firstSceneIndex]=toSwap;Editor.sendToCore("build-project",profile.platform,profile.buildPath,buildUuidList,profile)}else{this.$.tip.style.display="block";this.$.tip.animate([{color:"white"},{color:"red"},{color:"white"},{color:"red"}],{duration:300})}},buildButtonHoverInAction:function(event){this.hoverBuildButton=true},buildButtonHoverOutAction:function(){this.hoverBuildButton=false},previewAction:function(){Shell.openExternal("http://localhost:7456");Shell.beep()},showInFinder:function(){var profile=this.profiles.project;if(!Fs.existsSync(profile.buildPath)){Fire.warn("%s not exists!",profile.buildPath);return}Shell.showItemInFolder(Path.normalize(profile.buildPath));Shell.beep()},closeAction:function(){window.close()}})})();</script></polymer-element></body></html>