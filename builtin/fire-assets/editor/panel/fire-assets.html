<html><head><style>html /deep/ assets-tree[focused] assets-item[selected]::shadow #bar { background: #059;}html /deep/ assets-tree[focused] assets-item[conflicted]::shadow #bar { background: #900;}html /deep/ assets-item>assets-item { margin-left: 18px;}html /deep/ assets-item::shadow fire-ui-text-input { position: absolute; left: 9px; top: -1px; height: 18px; width: calc(100% - 9px);}html /deep/ assets-item::shadow fire-ui-text-input[icon] { left: 27px; width: calc(100% - 27px);}html /deep/ assets-item::shadow fire-ui-text-input::shadow .input-area { padding: 0px 1px;}html /deep/ assets-item::shadow .type-icon.folder { background-image: url("img/assets-folder.png");}html /deep/ assets-item::shadow .type-icon.db { background-image: url("img/assets-db.png");}html /deep/ assets-item::shadow .type-icon.fire { background-image: url("img/assets-fire.png");}html /deep/ assets-item::shadow .type-icon.txt { background-image: url("img/assets-txt.png");}html /deep/ assets-item::shadow .type-icon.js { background-image: url("img/assets-js.png");}html /deep/ assets-item::shadow .type-icon.co { background-image: url("img/assets-co.png");}html /deep/ assets-item::shadow .type-icon.ts { background-image: url("img/assets-ts.png");}html /deep/ assets-item::shadow .type-icon.html { background-image: url("img/assets-html.png");}html /deep/ assets-item::shadow .type-icon.css { background-image: url("img/assets-css.png");}html /deep/ assets-item::shadow .type-icon.anim { background-image: url("img/assets-anim.png");}html /deep/ assets-item::shadow .type-icon.bmfont { background-image: url("img/assets-bmfont.png");}html /deep/ assets-item::shadow .type-icon.sprite { background-image: url("img/assets-sprite.png");}html /deep/ assets-item::shadow .type-icon.audio { background-image: url("img/assets-audio.png");}html /deep/ assets-item::shadow .type-icon.atlas { background-image: url("img/assets-atlas.png");}html /deep/ assets-item::shadow .type-icon.fa-cube { color: #0f9;}html /deep/ assets-item::shadow .type-icon.fa-question-circle { color: #f00;}html /deep/ assets-item::shadow .type-icon.fa-fire { color: #dc5b3c;}</style></head><body><div hidden=""><polymer-element name="assets-item" extends="fire-ui-ti" constructor="AssetsItem" draggable="true" assetpath=""><template><style>:host([conflicted]) #bar { background-color: #900;}:host([highlighted]) #header { background-color: #c7722c;}:host([invalid]) #header { background-color: #f00;}:host { display: block; font-size: 12px; margin-left: 0px;}:host([folded]) #content { display: none;}#header { position: relative; padding-bottom: 1px;}#bar { position: absolute; left: 0; right: 0; height: 16px;}:host([selected]) #bar { background-color: #555;}.inline-block-wrapper { display: inline-block;}.flex-wrapper { display: flex; flex-direction: row; flex-wrap: nowrap; align-items: flex-end; white-space: nowrap; height: 16px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #aaa; cursor: default;}#foldIcon { font-size: 14px; width: 10px; margin-right: 2px; visibility: hidden; cursor: pointer; text-align: center;}:host([foldable]) #foldIcon { visibility: visible;}#typeIcon { font-size: 16px; width: 16px; height: 16px; margin-right: 2px;}#typeIcon[hidden] { display: none;}#typeIcon img { width: 16px; height: 16px;}#name.no-name { color: #6e6e6e;}#content { display: block;}</style><div id="bar"></div><div id="header"><div class="inline-block-wrapper"><div class="flex-wrapper"><i id="foldIcon" class="fa {{folded ? 'fa-caret-right' : 'fa-caret-down'}}" on-click="{{foldAction}}" on-dblclick="{{dblclickAction}}" on-mousedown="{{mousedownAction}}"></i><i id="typeIcon" hidden=""></i><span id="name" class="{{name === '' ? 'no-name' : ''}}">{{name === '' ? 'No Name' : name}}</span></div></div></div><div id="content"><content></content></div></template><script>(function(){function _binaryIndexOf(elements,key){var lo=0;var hi=elements.length-1;var mid,el;while(lo<=hi){mid=lo+hi>>1;name=elements[mid].name+elements[mid].extname;if(name<key){lo=mid+1}else if(name>key){hi=mid-1}else{return mid}}return lo}function _binaryInsert(parentEL,el){var idx=_binaryIndexOf(parentEL.children,el.name+el.extname);if(idx===-1){parentEL.appendChild(el)}else{parentEL.insertBefore(el,parentEL.children[idx])}}Polymer("assets-item",{publish:{conflicted:{value:false,reflect:true},highlighted:{value:false,reflect:true},invalid:{value:false,reflect:true}},created:function(){this.super();this.extname="";this.isRoot=false;this.isFolder=false;this.isSubAsset=false},addChild:function(child){_binaryInsert(this,child);this.foldable=true}})})();</script></polymer-element><polymer-element name="assets-tree" extends="fire-ui-tree" constructor="AssetsTree" on-open="{{openAction}}" on-contextmenu="{{contextmenuAction}}" on-dragstart="{{dragstartAction}}" on-dragend="{{dragendAction}}" on-dragover="{{dragoverAction}}" on-drop="{{dropAction}}" assetpath=""><template><style>:host::shadow .highlight { display: none; position: absolute; border: 2px solid #c7722c; box-sizing: border-box; pointer-events: none;}:host::shadow .highlight[invalid] { border: 2px solid #f00;}:host::shadow .insert { display: none; position: absolute; border: 1px solid #0f0; box-sizing: border-box; pointer-events: none;}</style><shadow></shadow></template><script>(function(){var Path=require("fire-path");var Url=require("fire-url");function _isTexture(extname){return extname===".png"||extname===".jpg"}function _newAssetsItem(url,type,id,parentEL){var newEL=new AssetsItem;newEL.isRoot=type==="root";newEL.isFolder=type==="folder"||newEL.isRoot;newEL.isSubAsset=!parentEL.isFolder;var extname="";var basename=Url.basename(url);if(!newEL.isFolder){extname=Url.extname(url);basename=Url.basename(url,extname)}var img;newEL.extname=extname;type=type||extname.toLowerCase();switch(type){case"root":newEL.setIcon("db");break;case"folder":newEL.setIcon("folder");break;case".fire":newEL.setIcon("fire");break;case".js":newEL.setIcon("js");break;case".coffee":newEL.setIcon("co");break;case".ts":newEL.setIcon("ts");break;case".txt":newEL.setIcon("txt");break;case".html":case".htm":case".xml":case".json":newEL.setIcon("html");break;case".css":case".less":case".styl":newEL.setIcon("css");break;case".anim":newEL.setIcon("anim");break;case".sprite":newEL.setIcon("sprite");break;case".fnt":case".bmf":case".bmfont":newEL.setIcon("bmfont");break;case".atlas":newEL.setIcon("atlas");break;case".mp3":case".wav":case".ogg":newEL.setIcon("audio");break;case".png":case".jpg":img=new Image;img.src="uuid://"+id+"?thumb";newEL.setIcon(img);break;case".asset":newEL.setIcon("fa fa-cube");break;default:newEL.setIcon("fa fa-question-circle");break}this.initItem(newEL,basename,id,parentEL);return newEL}function _getNameCollisions(target,list){var nodes=target.childNodes;var nodesLen=nodes.length;var len=list.length;var i,j;var name;var node;var collisions=[];for(i=0;i<len;i++){name=list[i];for(j=0;j<nodesLen;j++){node=nodes[j];if(node.name+node.extname===name){collisions.push(node)}}}return collisions}function _addCustomAssetMenu(target,template){function findMenu(menuArray,label){for(var i=0;i<menuArray.length;i++){if(menuArray[i].label===label){return menuArray[i]}}return null}function onclick(){var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=target.idToItem[contextSelection[0]];if(!targetEL.isFolder){targetEL=targetEL.parentElement}var url=target.getUrl(targetEL);var newAsset=new item.customAsset;var newAssetUrl=Url.join(url,fileName+".asset");Editor.AssetDB.generateUniqueUrl(newAssetUrl,function(uniqueUrl){target._focusUrl=uniqueUrl;Editor.AssetDB.save(uniqueUrl,Editor.serialize(newAsset))}.bind(target))}}var items=Fire._customAssetMenuItems;for(var i=0;i<items.length;i++){var item=items[i];var subPathes=item.menuPath.split("/");var fileName=subPathes.length>0?subPathes[subPathes.length-1]:subPathes[0];if(fileName===""){Fire.error("Invalid custom asset menu path: "+item.menuPath);continue}var prio=item.priority||0;var newMenu=null;for(var p=0,parent=template;p<subPathes.length;p++){var label=subPathes[p];if(!label){continue}var parentMenuArray=parent===template?template:parent.submenu;var menu;if(parentMenuArray){if(parentMenuArray.length>0){menu=findMenu(parentMenuArray,label)}if(menu){if(menu.submenu){parent=menu;continue}else{Fire.error("Custom Asset menu path %s conflict",item.menuPath);break}}}newMenu={label:label};if(!parentMenuArray){parent.submenu=[newMenu]}else{parentMenuArray.push(newMenu)}parent=newMenu}if(newMenu&&!newMenu.submenu){newMenu.click=onclick}else{Fire.error("Invalid custom asset menu path: "+item.menuPath)}}}Polymer("assets-tree",{created:function(){this.super();this.contextmenu=null;this.curDragoverEL=null;this.lastDragoverEL=null;this.dragenterCnt=0;this.confliction=[];this._focusUrl=null},ready:function(){this.super();this.addEventListener("dragenter",function(event){++this.dragenterCnt},true);this.addEventListener("dragleave",function(event){--this.dragenterCnt;if(this.dragenterCnt===0){this.resetDragState()}},true)},getCreateMenuTemplate:function(){return[{label:"New Folder",click:function(){var url="assets://";var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=this.idToItem[contextSelection[0]];if(!targetEL.isFolder)targetEL=targetEL.parentElement;url=this.getUrl(targetEL)}var newAssetUrl=Url.join(url,"New Folder");Editor.AssetDB.generateUniqueUrl(newAssetUrl,function(uniqueUrl){this._focusUrl=uniqueUrl;Editor.AssetDB.newFolder(uniqueUrl)}.bind(this))}.bind(this)},{type:"separator"},{label:"New Script",click:function(){var url="assets://";var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=this.idToItem[contextSelection[0]];if(!targetEL.isFolder)targetEL=targetEL.parentElement;url=this.getUrl(targetEL)}var newAssetUrl=Url.join(url,"NewComponent.js");Editor.AssetDB.generateUniqueUrl(newAssetUrl,function(uniqueUrl){this._focusUrl=uniqueUrl;Editor.AssetDB.newScript(uniqueUrl,"simple-component")}.bind(this))}.bind(this)},{type:"separator"},{label:"New Scene",click:function(){var url="assets://";var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=this.idToItem[contextSelection[0]];if(!targetEL.isFolder)targetEL=targetEL.parentElement;url=this.getUrl(targetEL)}var newAsset=new Fire._Scene;var camera=newAsset.addEntity("Main Camera");camera.addComponent(Fire.Camera);var newAssetUrl=Url.join(url,"New Scene.fire");Editor.AssetDB.generateUniqueUrl(newAssetUrl,function(uniqueUrl){this._focusUrl=uniqueUrl;Editor.AssetDB.save(uniqueUrl,Editor.serialize(newAsset))}.bind(this))}.bind(this)},{label:"New Atlas",click:function(){var url="assets://";var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=this.idToItem[contextSelection[0]];if(!targetEL.isFolder)targetEL=targetEL.parentElement;url=this.getUrl(targetEL)}var newAsset=new Fire.Atlas;var newAssetUrl=Url.join(url,"New Atlas.atlas");Editor.AssetDB.generateUniqueUrl(newAssetUrl,function(uniqueUrl){this._focusUrl=uniqueUrl;Editor.AssetDB.save(uniqueUrl,Editor.serialize(newAsset))}.bind(this))}.bind(this)},{label:"New Sprite (Standalone)",click:function(){var targetEL=null;var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){targetEL=this.idToItem[contextSelection[0]]}if(targetEL&&_isTexture(targetEL.extname)){var textureName=targetEL.name;Fire.AssetLibrary.loadAssetInEditor(targetEL.userId,function(error,asset){var newAsset=new Fire.Sprite;newAsset.texture=asset;newAsset.width=asset.width;newAsset.height=asset.height;var url=this.getUrl(targetEL.parentElement);var newAssetUrl=Url.join(url,textureName+".sprite");Editor.AssetDB.generateUniqueUrl(newAssetUrl,function(uniqueUrl){this._focusUrl=uniqueUrl;Editor.AssetDB.save(uniqueUrl,Editor.serialize(newAsset))}.bind(this))}.bind(this))}else{Fire.warn("Can not create sprite from non-texture element, please select a texture first.")}}.bind(this)},{type:"separator"}]},createContextMenu:function(){var template=[{label:"Create",submenu:this.getCreateMenuTemplate()},{type:"separator"},{label:"Rename",click:function(){var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=this.idToItem[contextSelection[0]];this.rename(targetEL)}}.bind(this)},{label:"Delete",click:function(){var contextSelection=Editor.Selection.contextAssets;var elements=this.getToplevelElements(contextSelection);for(var i=0;i<elements.length;i++){Editor.AssetDB.delete(this.getUrl(elements[i]))}}.bind(this)},{label:"Reimport",click:function(){var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var selectedItemEl=this.idToItem[contextSelection[0]];var url=this.getUrl(selectedItemEl);if(selectedItemEl.isFolder){while(selectedItemEl.firstChild){selectedItemEl.removeChild(selectedItemEl.firstChild)}selectedItemEl.foldable=false}Editor.AssetDB.reimport(url)}}.bind(this)},{type:"separator"},{label:"Show in "+(Fire.isWin32?"Explorer":"Finder"),click:function(){var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=this.idToItem[contextSelection[0]];Editor.AssetDB.explore(this.getUrl(targetEL))}}.bind(this)},{label:"Show in Library",click:function(){var contextSelection=Editor.Selection.contextAssets;if(contextSelection.length>0){var targetEL=this.idToItem[contextSelection[0]];Editor.AssetDB.exploreLib(this.getUrl(targetEL))}}.bind(this)},{label:"Show Uuid",click:function(){var contextSelection=Editor.Selection.contextAssets;for(var i=0;i<contextSelection.length;++i){var targetEL=this.idToItem[contextSelection[i]];Fire.log(targetEL.userId)}}.bind(this)}];var create=template[0].submenu;_addCustomAssetMenu(this,create);var Remote=require("remote");var Menu=Remote.require("menu");this.contextmenu=Menu.buildFromTemplate(template)},browse:function(url){var rootEL=_newAssetsItem.call(this,url,"root",Editor.UUID.AssetsRoot,this);rootEL.folded=false;Editor.AssetDB.deepQuery(url,function(results){for(var i=0;i<results.length;++i){var info=results[i];this.newItem(info.url,info.uuid,info.parentUuid,info.isDir)}}.bind(this))},newItem:function(url,id,parentId,isDirectory){var parentEL=this.idToItem[parentId];if(!parentEL){Fire.warn("Can not find element for "+parentId+" when import "+url);return}var type=isDirectory?"folder":"";var newEL=_newAssetsItem.call(this,url,type,id,parentEL);if(this._focusUrl===url){this._focusUrl=null;this.expand(newEL.userId);this.scrollToItem(newEL);Editor.Selection.selectAsset(newEL.userId,true,true)}},moveItem:function(id,destUrl,destDirId){var srcEL=this.idToItem[id];if(!srcEL){Fire.warn("Can not find source element: "+id);return}var destExtname=Path.extname(destUrl);var destBasename=Path.basename(destUrl,destExtname);srcEL.extname=destExtname;srcEL.name=destBasename;this.setItemParentById(id,destDirId);var parentEL=this.idToItem[destDirId];if(parentEL.isFolder){parentEL.folded=false}},deleteSelection:function(){var elements=this.getToplevelElements(Editor.Selection.assets);for(var i=0;i<elements.length;i++){Editor.AssetDB.delete(this.getUrl(elements[i]))}},getUrl:function(element){if(element.isRoot){return element.name+"://"}var url=element.name+element.extname;var parentEL=element.parentElement;while(parentEL instanceof AssetsItem){if(parentEL.isRoot){url=parentEL.name+"://"+url;break}else{url=Url.join(parentEL.name+parentEL.extname,url);parentEL=parentEL.parentElement}}return url},highlightBorder:function(item){if(item&&item instanceof AssetsItem){var style=this.$.highlightBorder.style;style.display="block";style.left=item.offsetLeft-2+"px";style.top=item.offsetTop-1+"px";style.width=item.offsetWidth+4+"px";style.height=item.offsetHeight+3+"px";item.highlighted=true}},highlightInsert:function(item,parentEL,position){var style=this.$.insertLine.style;if(item===this){item=this.firstChild}if(item===parentEL){style.display="none"}else if(item&&parentEL){style.display="block";style.left=parentEL.offsetLeft+"px";if(position==="before")style.top=item.offsetTop+"px";else style.top=item.offsetTop+item.offsetHeight+"px";style.width=parentEL.offsetWidth+"px";style.height="0px"}},highlightConflicts:function(items){for(var i=0;i<items.length;++i){var item=items[i];if(item.conflicted===false){item.conflicted=true;this.confliction.push(item)}}if(this.curDragoverEL){this.curDragoverEL.invalid=true}this.$.highlightBorder.setAttribute("invalid","")},cancelHighligting:function(){if(this.curDragoverEL){this.curDragoverEL.highlighted=false;this.$.highlightBorder.style.display="none";this.$.insertLine.style.display="none"}},cancelConflictsHighliting:function(){for(var i=0;i<this.confliction.length;++i){this.confliction[i].conflicted=false}this.confliction=[];if(this.curDragoverEL){this.curDragoverEL.invalid=false;this.$.highlightBorder.removeAttribute("invalid")}},resetDragState:function(){this.cancelHighligting();this.cancelConflictsHighliting();this.curDragoverEL=null;this.lastDragoverEL=null;this.dragenterCnt=0},moveAssets:function(targetEL,assets){var elements=this.getToplevelElements(assets);var targetUrl=this.getUrl(targetEL);for(var i=0;i<elements.length;++i){var el=elements[i];if(el===targetEL||el.parentElement===targetEL)continue;if(el.contains(targetEL)===false){var srcUrl=this.getUrl(el);var destUrl=Url.join(targetUrl,el.name+el.extname);Editor.AssetDB.move(srcUrl,destUrl)}}},select:function(element){Editor.Selection.selectAsset(element.userId,true,true)},clearSelect:function(){Editor.Selection.clearAsset();this.activeElement=null;this.shiftStartElement=null},selectingAction:function(event){event.stopPropagation();this.focus();var shiftStartEL=this.shiftStartElement;this.shiftStartElement=null;if(event.detail.shift){if(shiftStartEL===null){shiftStartEL=this.activeElement}this.shiftStartElement=shiftStartEL;var el=this.shiftStartElement;var userIds=[];if(shiftStartEL!==event.target){if(this.shiftStartElement.offsetTop<event.target.offsetTop){while(el!==event.target){userIds.push(el.userId);el=this.nextItem(el)}}else{while(el!==event.target){userIds.push(el.userId);el=this.prevItem(el)}}}userIds.push(event.target.userId);Editor.Selection.selectAsset(userIds,true,false)}else if(event.detail.toggle){if(event.target.selected){Editor.Selection.unselectAsset(event.target.userId,false)}else{Editor.Selection.selectAsset(event.target.userId,false,false)}}else{if(!event.target.selected){Editor.Selection.selectAsset(event.target.userId,true,false)}}},selectAction:function(event){event.stopPropagation();if(event.detail.shift){Editor.Selection.confirm()}else if(event.detail.toggle){Editor.Selection.confirm()}else{Editor.Selection.selectAsset(event.target.userId,true)}},renameConfirmAction:function(event){event.stopPropagation();var renamingEL=this.$.nameInput.renamingEL;this.$.nameInput.style.display="none";this.$.content.appendChild(this.$.nameInput);this.$.nameInput.renamingEL=null;window.requestAnimationFrame(function(){this.focus()}.bind(this));renamingEL._renaming=false;if(renamingEL.name!==event.target.value){var srcUrl=this.getUrl(renamingEL);var destUrl=Url.join(Url.dirname(srcUrl),event.target.value+renamingEL.extname);if(srcUrl.toLowerCase()===destUrl.toLowerCase()){Fire.warn("Renaming asset from lower case to upper case or vice verse will not be detected by Git.")}Editor.AssetDB.move(srcUrl,destUrl)}},openAction:function(event){event.stopPropagation();if(!(event.target instanceof AssetsItem)){return}Editor.sendToAll("asset:open",{uuid:event.target.userId,url:this.getUrl(event.target)})},contextmenuAction:function(event){event.preventDefault();event.stopPropagation();var Remote=require("remote");Remote.getCurrentWindow().focus();this.resetDragState();var curContextID=Editor.UUID.AssetsRoot;if(event.target instanceof AssetsItem){curContextID=event.target.userId}Editor.Selection.setContextAsset(curContextID);if(!this.contextmenu){this.createContextMenu()}this.contextmenu.popup(Remote.getCurrentWindow())},keydownAction:function(event){this.super([event]);if(event.cancelBubble){return}switch(event.which){case 46:this.deleteSelection();event.stopPropagation();break;case 8:if(event.metaKey){this.deleteSelection()}event.stopPropagation();break}},dragstartAction:function(event){event.stopPropagation();EditorUI.DragDrop.start(event.dataTransfer,"copyMove","asset",Editor.Selection.assets.map(function(item){var uuid=item;var itemEL=this.idToItem[uuid];return{name:itemEL.name,id:item}}.bind(this)))},dragendAction:function(event){EditorUI.DragDrop.end();this.resetDragState();Editor.Selection.cancel()},dragoverAction:function(event){var dragType=EditorUI.DragDrop.type(event.dataTransfer);if(dragType!=="file"&&dragType!=="asset"){EditorUI.DragDrop.allowDrop(event.dataTransfer,false);return}event.preventDefault();event.stopPropagation();if(event.target){this.lastDragoverEL=this.curDragoverEL;var dragoverTraget=event.target;if(event.target.isFolder===false)dragoverTraget=event.target.parentElement;if(event.target===this){dragoverTraget=this.firstChild}if(dragoverTraget!==this.lastDragoverEL){this.cancelHighligting();this.cancelConflictsHighliting();this.curDragoverEL=dragoverTraget;this.highlightBorder(dragoverTraget);var names=[];var i=0;var dragItems=EditorUI.DragDrop.items(event.dataTransfer);if(dragType==="file"){for(i=0;i<dragItems.length;i++){names.push(Path.basename(dragItems[i]))}}else if(dragType==="asset"){var srcELs=this.getToplevelElements(dragItems);for(i=0;i<srcELs.length;i++){var srcEL=srcELs[i];if(dragoverTraget!==srcEL.parentElement){names.push(srcEL.name+srcEL.extname)}}}var valid=true;if(names.length>0){var collisions=_getNameCollisions(dragoverTraget,names);if(collisions.length>0){this.highlightConflicts(collisions);valid=false}}EditorUI.DragDrop.allowDrop(event.dataTransfer,valid)}var bounding=this.getBoundingClientRect();var offsetY=event.clientY-bounding.top+this.scrollTop;var position="before";if(offsetY>=event.target.offsetTop+event.target.offsetHeight*.5)position="after";this.highlightInsert(event.target,dragoverTraget,position)}var dropEffect="none";if(dragType==="file"){dropEffect="copy"}else if(dragType==="asset"){dropEffect="move"}EditorUI.DragDrop.updateDropEffect(event.dataTransfer,dropEffect)},dropAction:function(event){var dragType=EditorUI.DragDrop.type(event.dataTransfer);if(dragType!=="asset"&&dragType!=="entity"&&dragType!=="file")return;event.preventDefault();event.stopPropagation();var items=EditorUI.DragDrop.drop(event.dataTransfer);var targetEL=this.curDragoverEL;this.resetDragState();Editor.Selection.cancel();if(items.length>0){if(dragType==="file"){var dstUrl=this.getUrl(targetEL);Editor.AssetDB.import(dstUrl,items)}else if(dragType==="asset"){this.moveAssets(targetEL,items)}}}})})();</script></polymer-element></div><polymer-element name="fire-assets" constructor="FireAssets" assetpath=""><template><style>:host { display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; font-size: 12px; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; color: #aaa; cursor: default; outline: none;}</style><fire-ui-toolbar><i id="addIcon" on-click="{{createAction}}" class="fa fa-plus"></i><fire-ui-text-input flex-1="" placeholder="Search..."></fire-ui-text-input></fire-ui-toolbar><assets-tree id="assetsTree" flex-1=""></assets-tree></template><script>(function(){Polymer("fire-assets",{created:function(){this.icon=new Image;this.icon.src="fire://static/img/plugin-assets.png"},attached:function(){Editor.mainWindow.$.assets=this},detached:function(){Editor.mainWindow.$.assets=null},"asset:hint":function(event){var uuid=event.detail.uuid;this.hint(uuid)},"folder:created":function(event){var url=event.detail.url;var id=event.detail.uuid;var parentId=event.detail.parentUuid;this.$.assetsTree.newItem(url,id,parentId,true)},"asset:created":function(event){var url=event.detail.url;var id=event.detail.uuid;var parentId=event.detail["parent-uuid"];this.$.assetsTree.newItem(url,id,parentId,false)},"asset:moved":function(event){var id=event.detail.uuid;var destUrl=event.detail["dest-url"];var destDirId=event.detail["dest-parent-uuid"];this.$.assetsTree.moveItem(id,destUrl,destDirId)},"assets:created":function(event){var results=event.detail.results;for(var i=0;i<results.length;++i){var info=results[i];this.$.assetsTree.newItem(info.url,info.uuid,info.parentUuid,info.isDir)}},"assets:deleted":function(event){var results=event.detail.results;var filterResults=Editor.arrayCmpFilter(results,function(a,b){if(Path.contains(a.url,b.url)){return 1}if(Path.contains(b.url,a.url)){return-1}return 0});for(var i=0;i<filterResults.length;++i){this.$.assetsTree.deleteItemById(filterResults[i].uuid)}},"fire-assets:refresh-context-menu":function(event){this.$.assetsTree.contextmenu=null},"selection:asset:selected":function(event){this.select(event.detail["id-list"],true)},"selection:asset:unselected":function(event){this.select(event.detail["id-list"],false)},"selection:asset:activated":function(event){this.active(event.detail.id,true)},"selection:asset:deactivated":function(event){this.active(event.detail.id,false)},browse:function(){Fire.info("browse assets://");this.$.assetsTree.browse("assets://")},select:function(ids,selected){for(var i=0;i<ids.length;++i){var id=ids[i];var el=this.$.assetsTree.idToItem[id];if(el){el.selected=selected}}},active:function(id,activated){if(activated){var el=this.$.assetsTree.idToItem[id];this.$.assetsTree.active(el)}else{this.$.assetsTree.active(null)}},hint:function(uuid){this.$.assetsTree.hintItem(uuid)},createAction:function(){var Remote=require("remote");var Menu=Remote.require("menu");var rect=this.$.addIcon.getBoundingClientRect();var template=this.$.assetsTree.getCreateMenuTemplate();var menu=Menu.buildFromTemplate(template);menu.popup(Remote.getCurrentWindow(),Math.floor(rect.left+5),Math.floor(rect.bottom+10))}})})();</script></polymer-element></body></html>