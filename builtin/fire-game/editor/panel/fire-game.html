<html><head></head><body><polymer-element name="fire-game" constructor="FireGame" on-show="{{showAction}}" on-hide="{{hideAction}}" on-resize="{{resizeAction}}" on-mousedown="{{mousedownAction}}" assetpath=""><template><style>:host { display: flex; flex-direction: column; flex-wrap: nowrap; align-items: stretch; font-size: 12px; white-space: nowrap; color: #ddd; background: #333; font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; cursor: default;}span.space { width: 5px;}span.text { margin-left: 5px; margin-right: 5px;}fire-ui-select { width: 180px;}fire-ui-unit-input { width: 60px;}.border { border: 1px solid #171717; position: relative; box-shadow: inset 0 0 10px 5px rgba(0,0,0,0.2); background: #292929;}#view:focus { outline: 0;}canvas { margin: auto; position: absolute; top: 0; left: 0; bottom: 0; right: 0; display: block;}canvas:focus { outline: 0;}</style><fire-ui-toolbar><fire-ui-select id="resolutionOptions" value="{{curResolution}}"></fire-ui-select><span class="space"></span><fire-ui-checkbox value="{{rotate}}">Rotate</fire-ui-checkbox><span class="space"></span><fire-ui-unit-input disabled="{{curResolution!==1}}" value="{{customWidth}}" type="int" unit="w" min="0"></fire-ui-unit-input><span class="text">X</span><fire-ui-unit-input disabled="{{curResolution!==1}}" value="{{customHeight}}" type="int" unit="h" min="0"></fire-ui-unit-input><span class="space"></span></fire-ui-toolbar><div class="border" flex-1=""><div id="view" fit=""></div></div></template><script>(function(){var resolutionList=[{name:"Free Aspect",type:"free",value:[-1,-1]},{name:"Custom Size",type:"custom",value:[-1,-1]},{name:"Display (4:3)",type:"ratio",value:[4,3]},{name:"Display (16:9)",type:"ratio",value:[16,9]},{name:"iPhone 4 (640 x 960)",type:"fixed",value:[640,960]},{name:"iPhone 5 (640 x 1136)",type:"fixed",value:[640,1136]},{name:"iPhone 6 (750 x 1334)",type:"fixed",value:[750,1334]},{name:"iPhone 6 Plus (1242 x 2208)",type:"fixed",value:[1242,2208]}];Polymer("fire-game",{created:function(){this.icon=new Image;this.icon.src="fire://static/img/plugin-game.png";this.renderContext=null;this.curResolution=0;this.rotate=false;this.customWidth=640;this.customHeight=480},observe:{curResolution:"resize",rotate:"resize",customWidth:"resize",customHeight:"resize"},ready:function(){this.$.resolutionOptions.options=resolutionList.map(function(item,idx){return{value:idx,name:item.name}});this.$.view.tabIndex=EditorUI.getParentTabIndex(this)+1},attached:function(){Editor.mainWindow.$.game=this},detached:function(){Editor.mainWindow.$.game=null},"scene:dirty":function(){this.delayRepaintScene()},"gizmos:dirty":function(){this.delayRepaintScene()},setRenderContext:function(renderContext){if(this.renderContext!==null){this.$.view.removeChild(this.renderContext.canvas)}this.renderContext=renderContext;if(this.renderContext!==null){this.$.view.appendChild(this.renderContext.canvas)}},resize:function(){if(!this.renderContext)return;var oldDisplay=this.style.display;this.style.display="";var size=[-1,-1];var resolutionInfo=resolutionList[this.curResolution];var contentRect=this.$.view.getBoundingClientRect();var srcWidth,srcHeight,ratio;if(resolutionInfo.type==="fixed"){if(this.rotate){srcWidth=resolutionInfo.value[1];srcHeight=resolutionInfo.value[0]}else{srcWidth=resolutionInfo.value[0];srcHeight=resolutionInfo.value[1]}size=Fire.fitSize(srcWidth,srcHeight,contentRect.width,contentRect.height)}else if(resolutionInfo.type==="ratio"){if(this.rotate){ratio=resolutionInfo.value[1]/resolutionInfo.value[0]}else{ratio=resolutionInfo.value[0]/resolutionInfo.value[1]}size=Fire.fitRatio(ratio,contentRect.width,contentRect.height)}else if(resolutionInfo.type==="custom"){if(this.rotate){srcWidth=this.customHeight;srcHeight=this.customWidth}else{srcWidth=this.customWidth;srcHeight=this.customHeight}size=Fire.fitSize(srcWidth,srcHeight,contentRect.width,contentRect.height)}else{size=[this.$.view.clientWidth,this.$.view.clientHeight]}this.renderContext.size=new Fire.Vec2(size[0],size[1]);this.style.display=oldDisplay;this.repaintScene()},repaintScene:function(){if(!this.renderContext)return;Fire.Engine._scene.render(this.renderContext)},delayRepaintScene:function(){if(this._repainting)return;this._repainting=true;setTimeout(function(){this.repaintScene();this._repainting=false}.bind(this),10)},showAction:function(event){this.repaintScene();this._repaintID=setInterval(this.repaintScene.bind(this),500)},hideAction:function(event){clearInterval(this._repaintID)},resizeAction:function(event){this.resize()},mousedownAction:function(event){event.stopPropagation();this.$.view.focus()}})})();</script></polymer-element></body></html>